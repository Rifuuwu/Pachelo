<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>PACHELO SCAN</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        .drop-area {
            border: 2px dashed #007bff;
            text-align: center;
            cursor: pointer;
        }

        .drop-area.hover {
            border-color: #0056b3;
        }
    </style>
</head>
<body class="">
<div class="container-md bg-white min-vh-100 ">
<!--    navbar-->
    <nav class="navbar border-bottom border-1 navbar-expand-lg">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">PACHELO</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar"
                    aria-controls="offcanvasNavbar" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasNavbar"
                 aria-labelledby="offcanvasNavbarLabel">
                <div class="offcanvas-header">
                    <h5 class="offcanvas-title" id="offcanvasNavbarLabel">PACHELO</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                </div>
                <div class="offcanvas-body">
                    <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
                        <li class="nav-item">
                            <a class="nav-link active" aria-current="page" href="#">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Link</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>
<!--    navbar end-->
    <div class="row pt-5 pb-3">
        <div class="col text-center">
            <h1 class="fw-bold ">PACHELO SCAN</h1>
            <p>Scan your web server log now!</p>
        </div>
    </div>
    <div class="row justify-content-center">
        <div class="col-md-8 px-5 px-md-0">
            <form id="uploadForm" action="/predict" method="post" enctype="multipart/form-data"
                  class="d-flex justify-content-center flex-column ">
                <div class="drop-area rounded-2 p-4 mb-2 bg-secondary-subtle" id="drop-area">
                    <i class="bi bi-file-earmark-text h1"></i>
                    <p class="pt-3 text-secondary">Seret dan jatuhkan file di sini atau klik untuk memilih file <br>
                        Maximum file size 10MB
                    </p>
                    <input type="file" name="file" id="fileElem" accept=".log" style="display:none;" required>
                </div>
                <div class="d-flex row-cols-2 gap-2 px-5 justify-content-center">
                    <button type="reset" class="btn btn-outline-secondary ms-2 ">Cancel</button>
                    <button type="submit" class="btn btn-primary ms-2">Prediksi</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
<script>
    const dropArea = document.getElementById('drop-area');
    const fileElem = document.getElementById('fileElem');
    const form = document .getElementById('uploadForm');

    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        dropArea.addEventListener(eventName, preventDefaults, false);
        document.body.addEventListener(eventName, preventDefaults, false);
    });

    ['dragenter', 'dragover'].forEach(eventName => {
        dropArea.addEventListener(eventName, () => dropArea.classList.add('hover'), false);
    });

    ['dragleave', 'drop'].forEach(eventName => {
        dropArea.addEventListener(eventName, () => dropArea.classList.remove('hover'), false);
    });

    dropArea.addEventListener('drop', handleDrop, false);
    dropArea.addEventListener('click', () => fileElem.click());

    function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
    }

    function handleDrop(e) {
        const dt = e.dataTransfer;
        const files = dt.files;
        handleFiles(files);
    }

    fileElem.addEventListener('change', (e) => {
        const files = e.target.files;
        handleFiles(files);
    });

    function handleFiles(files) {
        if (files.length > 0) {
            const fileName = files[0].name;
            dropArea.querySelector('p').textContent = `File yang dipilih: ${fileName}`;
        }
    }

    form.addEventListener('submit', (e) => {
        const files = fileElem.files;
        if (files.length > 0) {
            const file = files[0];
            if (file.size > 10 * 1024 * 1024) { // 10 MB
                e.preventDefault();
                alert('File harus berukuran tidak boleh lebih dari 10 MB.');
            }
        }
    });

    form.addEventListener('reset', () => {
        fileElem.value = '';
        dropArea.querySelector('p').innerHTML = "Seret dan jatuhkan file di sini atau klik untuk memilih file <br>\n" +
            "                        Maximum file size 10MB";
    });
</script>

</body>
</html>